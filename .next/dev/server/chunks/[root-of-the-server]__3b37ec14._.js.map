{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/alien/Development/tinkertank/tinkertank-market/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: ['query', 'error'],\n  });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAQ;AACzB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/alien/Development/tinkertank/tinkertank-market/src/app/api/admin/analytics/revenue/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\nimport { startOfDay, subDays, subWeeks, format } from 'date-fns';\n\nexport async function GET(request: Request) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const timeframe = searchParams.get('timeframe') || 'week';\n    \n    const now = new Date();\n    let startDate: Date;\n    let dateFormat: string;\n    let periods: number;\n\n    if (timeframe === 'month') {\n      startDate = subDays(now, 30);\n      dateFormat = 'MMM dd';\n      periods = 30;\n    } else {\n      startDate = subDays(now, 7);\n      dateFormat = 'EEE';\n      periods = 7;\n    }\n\n    const orders = await prisma.order.findMany({\n      where: {\n        status: 'PAID',\n        createdAt: {\n          gte: startDate,\n          lte: now,\n        },\n      },\n      orderBy: {\n        createdAt: 'asc',\n      },\n    });\n\n    // Group orders by date\n    const revenueByDate: { [key: string]: number } = {};\n    \n    for (let i = 0; i < periods; i++) {\n      const date = subDays(now, periods - 1 - i);\n      const dateKey = format(startOfDay(date), 'yyyy-MM-dd');\n      revenueByDate[dateKey] = 0;\n    }\n\n    orders.forEach((order) => {\n      const dateKey = format(startOfDay(order.createdAt), 'yyyy-MM-dd');\n      if (revenueByDate.hasOwnProperty(dateKey)) {\n        revenueByDate[dateKey] += parseFloat(order.totalAmount.toString());\n      }\n    });\n\n    const revenueData = Object.entries(revenueByDate).map(([date, revenue]) => ({\n      date,\n      revenue: Math.round(revenue * 100) / 100, // Round to 2 decimal places\n    }));\n\n    return NextResponse.json(revenueData);\n  } catch (error) {\n    console.error('Revenue analytics API error:', error);\n    return NextResponse.json({ error: 'Failed to fetch revenue data' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AAAA;;;;AAEO,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,YAAY,aAAa,GAAG,CAAC,gBAAgB;QAEnD,MAAM,MAAM,IAAI;QAChB,IAAI;QACJ,IAAI;QACJ,IAAI;QAEJ,IAAI,cAAc,SAAS;YACzB,YAAY,IAAA,oJAAO,EAAC,KAAK;YACzB,aAAa;YACb,UAAU;QACZ,OAAO;YACL,YAAY,IAAA,oJAAO,EAAC,KAAK;YACzB,aAAa;YACb,UAAU;QACZ;QAEA,MAAM,SAAS,MAAM,gIAAM,CAAC,KAAK,CAAC,QAAQ,CAAC;YACzC,OAAO;gBACL,QAAQ;gBACR,WAAW;oBACT,KAAK;oBACL,KAAK;gBACP;YACF;YACA,SAAS;gBACP,WAAW;YACb;QACF;QAEA,uBAAuB;QACvB,MAAM,gBAA2C,CAAC;QAElD,IAAK,IAAI,IAAI,GAAG,IAAI,SAAS,IAAK;YAChC,MAAM,OAAO,IAAA,oJAAO,EAAC,KAAK,UAAU,IAAI;YACxC,MAAM,UAAU,IAAA,kKAAM,EAAC,IAAA,0JAAU,EAAC,OAAO;YACzC,aAAa,CAAC,QAAQ,GAAG;QAC3B;QAEA,OAAO,OAAO,CAAC,CAAC;YACd,MAAM,UAAU,IAAA,kKAAM,EAAC,IAAA,0JAAU,EAAC,MAAM,SAAS,GAAG;YACpD,IAAI,cAAc,cAAc,CAAC,UAAU;gBACzC,aAAa,CAAC,QAAQ,IAAI,WAAW,MAAM,WAAW,CAAC,QAAQ;YACjE;QACF;QAEA,MAAM,cAAc,OAAO,OAAO,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,MAAM,QAAQ,GAAK,CAAC;gBAC1E;gBACA,SAAS,KAAK,KAAK,CAAC,UAAU,OAAO;YACvC,CAAC;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA+B,GAAG;YAAE,QAAQ;QAAI;IACpF;AACF","debugId":null}}]
}